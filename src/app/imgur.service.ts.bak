import { Injectable } from '@angular/core';
import { FirebaseStorage } from "@angular/fire";
import * as firebase from "firebase";

@Injectable({
  providedIn: 'root'
})

export class ImgurService {

  constructor(
    private _firebaseStorage: FirebaseStorage) {

  }

  // Upload Image to Firebase Storage and return its URL
  async uploadImageAndReturnURL(image: File) {
    console.log(image);
    // Set the reference to firebase storage
    //var storage = this._firebaseStorage.ref();
    var storage = firebase.storage().ref();
    // Save the image as imageName in firebase storage under the appropriate folder
    var imageName = image.name;
    return await storage.child("recipe_images/" + imageName).put(image).then(async results => {
      return await results.ref.getDownloadURL().then(async url => {
        console.log(url);
        // Return the url of the image once uploaded
        return await url;
      });
    });
  }
}
